{% assign section_id = section.id | replace: "_", "" | replace: "-", "" %}
{% render "section-styles", section_id: section_id, section: section %}

<link href="{{ "main-account.css" | asset_url }}" rel="stylesheet">
<link href="{{ "account-orders.css" | asset_url }}" rel="stylesheet">

<div class="wrap wrap--large wrap--{{section_id }}">

    <div class="section-account__new-customer hidden">
        <span>{{ "customer.orders.welcome_message" | t: email: customer.email }}</span>
    </div>

    <div class="section-account__inner">

        {% render "account-aside" %}
        
        <div class="section-account__container section-orders__content" id="customer-orders">

            <div class="section-account__header">
                <h2>{{ 'customer.orders.orders_title' | t }}</h2>
            </div>

            {% paginate customer.orders by 999 %}
            {% if customer.orders.size != 0 %}
            <ul class="orders">
                {% for order in customer.orders %}
                    {% assign count = 0 %}
                    {% for line_item in order.line_items %}
                        {% assign count = count | plus: 1 %}
                    {% endfor %}
                    <li class="orders__order">
                        <div class="orders__order-info">
                            <div class="orders__order-media">
                            {% for line_item in order.line_items %}
                                {% if forloop.first == true %}
                                <a href="{{ order.customer_url }}">
                                    <img src="{{ line_item.image.src | img_url: "180x180", crop: "center" }}">
                                </a>
                                {% endif %}
                            {% endfor %}
                            </div>
                            <div class="orders__order-details">
                                <h4 class="orders__order-name"><a href="{{ order.customer_url }}">Order: {{ order.name }}</a></h4>
                                <div class="orders__order-meta">
                                    <p class="orders__order-date">{{ 'customer.orders.order_date' | t }} <span>{{ order.created_at | date: "%b %d, %Y" }}</span></p>
                                    <p class="orders__order-summary">{{ 'customer.orders.order_summary' | t }} <span>{{ count }} {{ 'customer.orders.order_summary_items' | t }}</span></p>
                                    <p class="orders__order-status">{{ 'customer.orders.order_status' | t }} <span>{{ order.financial_status | capitalize }}</span></p>
                                    <p class="orders__order-total">{{ 'customer.orders.order_total' | t }} <span>{{ order.total_price | money }}</span></p>
                                </div>
                                <p class="orders__order-link"><a href="{{ order.customer_url }}" class="underline underline--orange underline--heavy">{{ 'customer.orders.view_order' | t }}</a></p>
                            </div>
                        </div>
                    </li>
                {% endfor %}
            </ul>
            {% else %}
            <span>{{ 'customer.orders.no_orders' | t }}</span>
            {% endif %}
            {{ paginate | default_pagination }}
            {% endpaginate %}
        </div>

    </div>

</div>

{% schema %}
{
    "name": "Account",
    "tag": "section",
    "class": "section-account section-orders",
    "settings": [
        {
            "type": "header",
            "content": "Desktop padding"
        },
        {
            "type": "range",
            "id": "padding_top",
            "min": 0,
            "max": 128,
            "step": 2,
            "unit": "px",
            "label": "Padding top",
            "default": 64
        },
        {
            "type": "range",
            "id": "padding_bottom",
            "min": 0,
            "max": 128,
            "step": 2,
            "unit": "px",
            "label": "Padding bottom",
            "default": 64
        },
        {
            "type": "header",
            "content": "Mobile padding"
        },
        {
            "type": "range",
            "id": "mobile_padding_top",
            "min": 0,
            "max": 128,
            "step": 2,
            "unit": "px",
            "label": "Padding top",
            "default": 32
        },
        {
            "type": "range",
            "id": "mobile_padding_bottom",
            "min": 0,
            "max": 128,
            "step": 2,
            "unit": "px",
            "label": "Padding bottom",
            "default": 32
        }
    ]
}
{% endschema %}